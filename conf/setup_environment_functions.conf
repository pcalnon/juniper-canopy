#!/usr/bin/env bash
#####################################################################################################################################################################################################
# Project:       Juniper
# Sub-Project:   JuniperCanopy
# Application:   juniper_canopy
# Purpose:       Monitoring and Diagnostic Frontend for Cascade Correlation Neural Network
#
# Author:        Paul Calnon
# Version:       0.1.4 (0.7.3)
# File Name:     setup_environment_functions.conf
# File Path:     <Project>/<Sub-Project>/<Application>/conf/
#
# Date:          2025-10-11
# Last Modified: 2026-01-04
#
# License:       MIT License
# Copyright:     Copyright (c) 2024,2025,2026 Paul Calnon
#
# Description:
#    This script sets up the development environment for the Juniper Canopy application.
#
#####################################################################################################################################################################################################
# Notes:
#     Juniper Canopy Environment Setup Script
#     This script sets up the development environment for the Juniper Canopy application
#
########################################################################################################)#############################################################################################
# References:
#
#####################################################################################################################################################################################################
# TODO :
#
#####################################################################################################################################################################################################
# COMPLETED:
#
#####################################################################################################################################################################################################


#####################################################################################################################################################################################################
# Only Source this conf file Once
#####################################################################################################################################################################################################
if [[ "${SETUP_ENVIRONMENT_FUNCTIONS_SOURCED}" != "${TRUE}" ]]; then
    export SETUP_ENVIRONMENT_FUNCTIONS_SOURCED="${TRUE}"
else
    log_warning "setup_environment_functions.conf already sourced.  Skipping re-source."
    return $(( TRUE ))
fi


#####################################################################################################################################################################################################
# Define Testing Environment Validation Script Content
#####################################################################################################################################################################################################
ENV_TEST_SCRIPT_CONTENT="
${ENV_TEST_SCRIPT_SHEBANG}
${ENV_TEST_SCRIPT_DESC}
${ENV_TEST_SCRIPT_IMPORTS}

def ${ENV_TEST_IMPORTS_FN}():
    ${ENV_TEST_IMPORTS_PACKAGE_DOCSTRING}
    ${ENV_TEST_PACKAGE_IMPORTS_HEADER}
    packages = ${ENV_TEST_IMPORTS_PACKAGES}
    for package in packages:
        try:
            __import__(package)
            ${ENV_TEST_IMPORTS_PACKAGE_FOUND}
        except ImportError as e:
            ${ENV_TEST_IMPORTS_PACKAGE_MISSING}
            return ${PY_FALSE}
    return ${PY_TRUE}

def ${ENV_TEST_LOGGING_FN}():
    ${ENV_TEST_LOGGING_FRAME_DOCSTRING}
    ${ENV_TEST_LOGGING_FRAME_HEADER}
    try:
        sys.path.append(\"${SRC_DIR_NAME}\")
        from logging.logger import get_system_logger, get_training_logger
        system_logger = get_system_logger()
        training_logger = get_training_logger()
        ${ENV_TEST_LOGGING_SYSTEM_TEST}
        ${ENV_TEST_LOGGING_TRAINING_TEST}
        ${ENV_TEST_LOGGING_FRAME_FOUND}
        return ${PY_TRUE}
    except Exception as e:
        ${ENV_TEST_LOGGING_FRAME_MISSING}
        return ${PY_FALSE}

def ${ENV_TEST_DIRS_FN}():
    ${ENV_TEST_DIRS_FN_DOCSTRING}
    ${ENV_TEST_DIR_STRUCTURE_HEADER}
    required_dirs = ${ENV_TEST_REQUIRED_DIRS}
    for dir_name in required_dirs:
        if os.path.exists(dir_name):
            ${ENV_TEST_DIR_STRUCTURE_FOUND}
        else:
            ${ENV_TEST_DIR_STRUCTURE_MISSING}
            return ${PY_FALSE}
    return ${PY_TRUE}

def main():
    ${ENV_TEST_SCRIPT_RESULT_HEADER}
    tests = ${TESTING_ENVIRONMENT_VALIDATION_SCRIPTS}
    passed = 0
    for test_name, test_func in tests:
        ${ENV_TEST_MAIN_CURRENT_TEST}
        if test_func():
            passed += 1
    ${ENV_TEST_MAIN_RESULT_NUMBERS}
    if passed == len(tests):
        ${ENV_TEST_MAIN_RESULT_SUCCESS}
    else:
        ${ENV_TEST_MAIN_RESULT_FAILURE}
        sys.exit(1)

if __name__ == \"__main__\":
    main()
"


#####################################################################################################################################################################################################
# Creating Testing Environment Validation Script
#####################################################################################################################################################################################################
log_trace "Creating Testing Environment Validation Script"
echo -e "${ENV_TEST_SCRIPT_CONTENT}" > "${TESTING_ENVIRONMENT_VALIDATION_SCRIPT_FILE}"

return $(( TRUE ))
